Как можно всё тестировать.

=============================================================================================

Дано:

===============================

Доменная модель User. Имплементирующая интерфейс IUser.

В этой модели пользуемся терминами, на которых говорит бизнес и клиент. Никакого упоминания о базе данных.
Подразумеваем, что мы не в курсе как хранятся данные. Есть некое хранилище, реализующее некий интерфейс.

```js
class User {
  constructor (storage) {
    this.storage = storage; // Модель, имплементирующая интерфейс.
  }
  register(email, password);
}
```

Что в этом классе можно потестировать:

* Что он вызывает определенные методы storage в нужном порядке.
* Что он вызывает определенные свои приватные методы в нужном порядке.
* Что он как-то изменяет свои приватные переменные.
* Что он вызывает third-party функции, м.б. из каких-то npm модулей.
* Если он влияет на что-то, то потестить и это влияние.







===============================

Контроллер.

```js
class UsersController {
  constructor(userDomainModel) {
    this.userDomainModel = userDomainModel;
  }
}
```

===============================

DB модель DbUser, имплементирующая интерфейс IDbUser.

```js
class DbUser {
  constructor (SQLExecutor) {
    this.storage = storage; // Модель, имплементирующая интерфейс.
  }
  register(email, password);
}
```

?? DbModel - аналог ORM ?




У контроллера (допустим, через инжектирование в конструкторе есть объект доменной модели User)

=======================================================================================

Допустим мы хотим все сделать на юнит тестах.

Допустим, мы тестируем User.register.

Подсунув стаб для IDbUser мы убеждаемся, что ф-я, 





=======================================================================================





Вопросы:

Как в автотесте убедиться, что он правильный.
Если у нас есть последовательность вызовов стабов ф-й, с параметрами.


В тесте со стабами доменной модели, будет просто подтверждение, что ф-и модели вызваны так, как они написаны в контроллере.
Но как убедиться, что эта последовательность вызовов правильная ?



Формирователь запроса к БД. екзекутор запроса к БД.








